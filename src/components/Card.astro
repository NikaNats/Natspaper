---
import { slugifyStr } from "@/utils/slugify";
import Datetime from "./Datetime.astro";

export interface Props {
  title: string;
  description: string;
  pubDatetime: Date;
  modDatetime?: Date | null;
  timezone?: string;
  slug: string;
  variant?: "h2" | "h3";
}

const {
  title,
  description,
  pubDatetime,
  modDatetime,
  timezone,
  slug,
  variant = "h2",
} = Astro.props;

// REFACTORED: Use a dynamic tag to avoid repetition. This is the key change.
const HeadingTag = variant === "h2" ? "h2" : "h3";
---

<li class="my-8">
  <a
    href={`/${Astro.currentLocale}/posts/${slug}`}
    class="group block no-underline focus-visible:outline-2 focus-visible:outline-offset-1 focus-visible:outline-accent focus-visible:outline-dashed"
  >
    <article
      class="post-entry border-l-4 border-l-transparent py-3 pl-4 transition-colors group-hover:border-l-accent group-focus-visible:border-l-accent"
    >
      {/* REFACTORED: Render the dynamic tag. No more ternary operator. */}
      <HeadingTag
        class="text-lg font-semibold text-foreground decoration-dashed transition-colors hover:text-accent"
        style={{ viewTransitionName: slugifyStr(title) }}
      >
        {title}
      </HeadingTag>

      <div class="mt-2 text-sm text-text-secondary">
        <Datetime {pubDatetime} {modDatetime} {timezone} />
      </div>

      <p class="mt-3 line-clamp-3 leading-relaxed text-foreground">
        {description}
      </p>
    </article>
  </a>
</li>

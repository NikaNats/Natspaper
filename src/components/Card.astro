---
import { slugifyStr } from "@/utils/slugify";
import type { CollectionEntry } from "astro:content";
import { getPath } from "@/utils/getPath";
import Datetime from "./Datetime.astro";

export interface Props extends CollectionEntry<"blog"> {
  variant?: "h2" | "h3";
}

const { variant = "h2", data, id, filePath } = Astro.props;

const { title, description, pubDatetime, modDatetime, timezone } = data;

const headerProps = {
  style: { viewTransitionName: slugifyStr(title) },
  class:
    "text-lg font-semibold text-foreground decoration-dashed hover:text-accent transition-colors",
};
---

<li class="my-8">
  <a
    href={getPath(id, filePath)}
    class="group block no-underline focus-visible:outline-2 focus-visible:outline-offset-1 focus-visible:outline-accent focus-visible:outline-dashed"
  >
    <!-- Post Entry Card: Full clickable area for better UX -->
    <article
      class="post-entry border-l-4 border-l-transparent py-3 pl-4 transition-colors group-hover:border-l-accent group-focus-visible:border-l-accent"
    >
      {
        variant === "h2" ? (
          <h2 {...headerProps}>{title}</h2>
        ) : (
          <h3 {...headerProps}>{title}</h3>
        )
      }
      <!-- Subtle metadata display -->
      <div class="mt-2 text-sm text-text-secondary">
        <Datetime {pubDatetime} {modDatetime} {timezone} />
      </div>
      <!-- Multi-line excerpt for content preview -->
      <p class="mt-3 line-clamp-3 leading-relaxed text-foreground">
        {description}
      </p>
    </article>
  </a>
</li>

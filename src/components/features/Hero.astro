---
/**
 * Elastic Hero Component
 * ======================
 * A fully responsive, accessible hero section with elastic scaling.
 *
 * Features:
 * - Fluid typography using clamp() for smooth scaling 320px → 2560px
 * - CSS Container queries for true component-level responsiveness
 * - Optimized images with AVIF/WebP support via Astro Picture
 * - Elastic spacing that scales proportionally with viewport
 * - Subtle animations with reduced-motion support
 * - Semantic HTML with proper heading hierarchy
 * - Accessible: proper alt text, focus states, ARIA labels
 *
 * @example
 * <Hero
 *   name="John Doe"
 *   tagline=".NET Developer | Software Engineer"
 *   description="Building scalable microservices..."
 *   profileImage={profilePic}
 * />
 */
import { Picture } from "astro:assets";
import type { ImageMetadata } from "astro";

export interface Props {
  /** Author/profile name - displayed as h1 */
  name: string;
  /** Professional tagline/title */
  tagline: string;
  /** Main description/bio text */
  description: string;
  /** Additional description paragraphs (optional) */
  additionalContent?: string[];
  /** Profile image source */
  profileImage: ImageMetadata;
  /** Profile image alt text */
  profileAlt?: string;
  /** Tech stack pills to display */
  techStack?: string[];
  /** Slot for social links component */
  class?: string;
}

const {
  name,
  tagline,
  description,
  additionalContent = [],
  profileImage,
  profileAlt = "Profile",
  techStack = [],
  class: className = "",
} = Astro.props;
---

<section
  id="hero"
  class:list={["hero", className]}
  aria-labelledby="hero-heading"
>
  <!-- Animated background gradient blob -->
  <div class="hero__backdrop" aria-hidden="true">
    <div class="hero__blob"></div>
  </div>

  <div class="hero__container">
    <!-- Profile Image with elastic sizing -->
    <div class="hero__image-wrapper">
      <Picture
        src={profileImage}
        formats={["avif", "webp"]}
        widths={[120, 160, 200, 280, 320]}
        sizes="(min-width: 1536px) 280px, (min-width: 1024px) 200px, (min-width: 640px) 160px, 120px"
        alt={profileAlt}
        title={profileAlt}
        width={280}
        height={280}
        class="hero__image"
        loading="eager"
        fetchpriority="high"
        decoding="sync"
      />
    </div>

    <!-- Text Content -->
    <div class="hero__content">
      <h1 id="hero-heading" class="hero__name">
        {name}
      </h1>

      <p class="hero__tagline">
        {tagline}
      </p>

      <p class="hero__description">
        {description}
      </p>

      {
        additionalContent.map(content => (
          <p
            class="hero__description hero__description--additional"
            set:html={content}
          />
        ))
      }

      <!-- Tech Stack Pills -->
      {
        techStack.length > 0 && (
          <div
            class="hero__tech-stack"
            role="list"
            aria-label="Technology stack"
          >
            {techStack.map(tech => (
              <span class="hero__tech-pill" role="listitem">
                {tech}
              </span>
            ))}
          </div>
        )
      }

      <!-- Social Links Slot -->
      <div class="hero__socials">
        <slot name="socials" />
      </div>
    </div>
  </div>
</section>

<style>
  /* ==========================================================================
     HERO COMPONENT - Elastic Responsive Design
     ==========================================================================
     Uses modern CSS features for true elasticity:
     - Container queries for component-level breakpoints
     - Fluid typography with clamp()
     - Logical properties for RTL support
     - Custom properties for theming
     ========================================================================== */

  .hero {
    /* Container query context */
    container-type: inline-size;
    container-name: hero;

    /* Fluid values scale from 320px to 1280px, then stay fixed */
    --hero-padding-block: clamp(1.5rem, 1.5vw + 0.5rem, 2.5rem);
    --hero-padding-inline: clamp(1rem, 2vw, 2.5rem);

    /* Fluid spacing - caps at 1280px */
    --hero-gap: clamp(1.25rem, 1vw + 0.5rem, 1.75rem);
    --hero-content-gap: clamp(0.5rem, 0.5vw + 0.25rem, 0.875rem);

    /* Image sizing - caps at ~10rem */
    --hero-image-size: clamp(8rem, 5vw + 5rem, 10rem);

    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding-block: var(--hero-padding-block);
    padding-inline: var(--hero-padding-inline);
    text-align: center;
    overflow: hidden;
  }

  /* Animated Background Blob */
  .hero__backdrop {
    position: fixed;
    inset: 0;
    z-index: -10;
    display: flex;
    align-items: center;
    justify-content: center;
    pointer-events: none;
  }

  .hero__blob {
    /* Caps at ~500px after 1280px viewport */
    --blob-size: clamp(18rem, 20vw + 10rem, 31.25rem);

    width: var(--blob-size);
    height: var(--blob-size);
    border-radius: 50%;
    background: var(--color-accent, #0066ff);
    opacity: 0.1;
    filter: blur(clamp(60px, 5vw + 20px, 100px));
    animation: blob-pulse 8s ease-in-out infinite alternate;
  }

  @keyframes blob-pulse {
    0% {
      transform: scale(1) translate(0, 0);
    }
    100% {
      transform: scale(1.15) translate(2%, -2%);
    }
  }

  /* Reduced motion: disable animations */
  @media (prefers-reduced-motion: reduce) {
    .hero__blob {
      animation: none;
    }
  }

  /* Container Layout */
  .hero__container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--hero-gap);
    width: 100%;
    max-width: 72rem; /* 1152px */
  }

  /* Profile Image Wrapper */
  .hero__image-wrapper {
    flex-shrink: 0;
  }

  .hero__image {
    width: var(--hero-image-size);
    height: var(--hero-image-size);
    border-radius: 50%;
    object-fit: cover;

    /* Elastic glow effect */
    --glow-spread: clamp(30px, 5vw, 60px);
    box-shadow:
      0 0 var(--glow-spread) calc(var(--glow-spread) * -0.25)
        var(--color-accent, #0066ff),
      inset 0 0 0 2px
        color-mix(in srgb, var(--color-accent, #0066ff) 50%, transparent);

    /* Ring effect using outline for better browser support */
    outline: 2px solid
      color-mix(in srgb, var(--color-accent, #0066ff) 50%, transparent);
    outline-offset: 0;

    /* Smooth transition for theme changes */
    transition:
      box-shadow 0.3s ease,
      outline-color 0.3s ease,
      transform 0.3s ease;
  }

  /* Subtle hover effect on image */
  .hero__image-wrapper:hover .hero__image {
    transform: scale(1.02);
  }

  @media (prefers-reduced-motion: reduce) {
    .hero__image-wrapper:hover .hero__image {
      transform: none;
    }
  }

  /* Content Section */
  .hero__content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--hero-content-gap);
    max-width: 48rem; /* 768px - optimal reading width */
  }

  /* Fluid Typography - scales 320px → 1280px, then fixed */
  .hero__name {
    /* Caps at 2.75rem (~44px) at 1280px */
    font-size: clamp(2rem, 1rem + 2.5vw, 2.75rem);
    font-weight: 700;
    line-height: 1.1;
    letter-spacing: -0.02em;
    color: var(--color-foreground);
    margin: 0;
  }

  .hero__tagline {
    /* Caps at 1.5rem (24px) at 1280px */
    font-size: clamp(1.125rem, 0.875rem + 0.625vw, 1.5rem);
    font-weight: 600;
    line-height: 1.3;
    margin: 0;

    /* Gradient text effect */
    background: linear-gradient(
      135deg,
      var(--color-accent, #0066ff) 0%,
      color-mix(in srgb, var(--color-accent, #0066ff) 60%, #a855f7) 100%
    );
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }

  .hero__description {
    /* Caps at 1.0625rem (17px) at 1280px */
    font-size: clamp(1rem, 0.9375rem + 0.15vw, 1.0625rem);
    line-height: 1.7;
    color: var(--color-foreground);
    margin: 0;
    max-width: 42rem; /* Optimal line length */
  }

  .hero__description--additional {
    margin-block-start: 0.5rem;
    color: var(--color-text-secondary);
  }

  /* Links within description */
  .hero__description :global(a) {
    text-decoration: underline;
    text-decoration-style: dashed;
    text-underline-offset: 4px;
    color: inherit;
    transition: color 0.2s ease;
  }

  .hero__description :global(a:hover),
  .hero__description :global(a:focus) {
    color: var(--color-accent);
  }

  /* Inline highlights/badges */
  .hero__description :global(.highlight) {
    display: inline-block;
    padding: 0rem 0.25rem;
    font-family: var(--font-mono, monospace);
    font-size: 0.875em;
    border: 1px solid color-mix(in srgb, var(--color-accent) 20%, transparent);
    border-radius: 0.25rem;
    background: color-mix(in srgb, var(--color-accent) 10%, transparent);
    color: var(--color-accent);
    line-height: 1.5;
  }

  /* Tech Stack Pills */
  .hero__tech-stack {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: clamp(0.5rem, 1vw, 0.75rem);
    margin-block-start: clamp(1rem, 2vw, 2rem);
  }

  .hero__tech-pill {
    /* Fluid pill sizing */
    padding-inline: clamp(0.625rem, 1vw + 0.25rem, 1rem);
    padding-block: clamp(0.25rem, 0.5vw, 0.5rem);
    font-size: clamp(0.75rem, 0.7rem + 0.15vw, 0.875rem);
    font-weight: 500;
    line-height: 1;

    border: 1px solid color-mix(in srgb, var(--color-accent) 20%, transparent);
    border-radius: 9999px;
    background: color-mix(in srgb, var(--color-accent) 5%, transparent);
    color: var(--color-foreground);

    cursor: default;
    transition:
      transform 0.2s ease,
      border-color 0.2s ease,
      background-color 0.2s ease,
      color 0.2s ease;
  }

  .hero__tech-pill:hover {
    transform: translateY(-2px);
    border-color: color-mix(in srgb, var(--color-accent) 50%, transparent);
    background: color-mix(in srgb, var(--color-accent) 10%, transparent);
    color: var(--color-accent);
  }

  @media (prefers-reduced-motion: reduce) {
    .hero__tech-pill:hover {
      transform: none;
    }
  }

  /* Social Links Container */
  .hero__socials {
    margin-block-start: clamp(1rem, 2vw, 2rem);
  }

  /* ==========================================================================
     CONTAINER QUERIES - Component-level Responsiveness
     ==========================================================================
     These kick in based on the hero container's width, not the viewport.
     This makes the component truly reusable in different layout contexts.
     ========================================================================== */

  /* Medium containers (≥640px) - slight layout adjustments */
  @container hero (min-width: 40rem) {
    .hero__name {
      letter-spacing: -0.025em;
    }

    .hero__description {
      max-width: 38rem;
    }
  }

  /* Large containers (≥1024px) - enhanced spacing and sizing */
  @container hero (min-width: 64rem) {
    .hero {
      --hero-gap: clamp(2rem, 3vw, 3.5rem);
    }

    .hero__content {
      gap: clamp(1rem, 1.5vw, 1.5rem);
    }
  }

  /* Extra large containers (≥1280px) - maintain proportions */
  @container hero (min-width: 80rem) {
    .hero__description {
      max-width: 44rem;
    }
  }

  /* ==========================================================================
     VIEWPORT-BASED FALLBACKS
     ==========================================================================
     For browsers without container query support (fallback behavior)
     ========================================================================== */

  @supports not (container-type: inline-size) {
    @media (min-width: 80rem) {
      .hero__description {
        max-width: 44rem;
      }
    }
  }

  /* ==========================================================================
     LARGE DISPLAYS (1920px+)
     ==========================================================================
     Proportional scaling continues - same visual feel, just larger
     ========================================================================== */

  @media (min-width: 1920px) {
    .hero__description {
      max-width: 48rem;
    }
  }

  @media (min-width: 2560px) {
    .hero__description {
      max-width: 52rem;
    }
  }
</style>

---
import { isActive } from "./NavLinks.astro";
import { NAVIGATION } from "@/config";
import LinkButton from "../ui/LinkButton.astro";
import IconArchive from "@/assets/icons/IconArchive.svg";
import { FEATURES } from "@/config";
import LanguagePicker from "../features/LanguagePicker.astro";
import IconMoon from "@/assets/icons/IconMoon.svg";
import IconSunHigh from "@/assets/icons/IconSunHigh.svg";
import { getI18n } from "@/i18n";
import type { UIKey } from "@/i18n/dictionaries/ui";

const { currentPath, locale, otherLanguageLinks } = Astro.props;
const { t } = getI18n(locale);
---

<ul
  class:list={[
    Astro.props.class,
    "flex flex-col items-center gap-6 md:flex-row md:gap-3",
  ]}
>
  {/* Dynamically render main nav links from configuration */}
  {
    NAVIGATION.filter(link => link.href !== "/archives").map(link => (
      <li>
        <a
          href={`/${locale}${link.href}`}
          class:list={{
            "active-nav text-accent": isActive(currentPath, link.href, locale),
          }}
          class="flex min-h-11 items-center rounded-md px-3 py-2 font-sans text-base font-medium text-foreground no-underline transition-colors hover:bg-muted hover:text-accent focus:outline-none md:min-h-9 md:px-2 md:text-sm"
        >
          {t(link.text as UIKey)} {/* Use i18n key from config */}
        </a>
      </li>
    ))
  }
  {
    FEATURES.showArchives && (
      <li>
        <LinkButton
          href={`/${locale}/archives`}
          class:list={[
            "flex min-h-11 min-w-11 items-center justify-center rounded-md p-2.5 text-foreground transition-colors hover:bg-muted hover:text-accent focus:outline-none md:min-h-9 md:min-w-9",
            {
              "active-nav text-accent": isActive(
                currentPath,
                "/archives",
                locale
              ),
            },
          ]}
          ariaLabel={t("nav.archives")}
          title={t("nav.archives")}
        >
          <IconArchive class="size-5" aria-hidden="true" />
          <span class="sr-only">{t("nav.archives")}</span>
        </LinkButton>
      </li>
    )
  }
  {
    FEATURES.lightAndDarkMode && (
      <li>
        <button
          id="theme-btn"
          class="inline-flex min-h-11 min-w-11 items-center justify-center rounded-md p-2.5 text-foreground transition-colors hover:bg-muted hover:text-accent focus:outline-none md:min-h-9 md:min-w-9"
          title="Toggle light & dark theme"
          aria-label="Toggle theme"
          aria-live="polite"
        >
          <IconMoon class="hidden size-5 dark:block" aria-hidden="true" />
          <IconSunHigh class="size-5 dark:hidden" aria-hidden="true" />
        </button>
      </li>
    )
  }
  <li>
    <LanguagePicker links={otherLanguageLinks} />
  </li>
</ul>

---
/**
 * Responsive Post Content Component
 * ==================================
 * Article content wrapper with optimal reading experience.
 *
 * Features:
 * - Container queries for component-level responsiveness
 * - Width controlled by parent (720px from PostDetails.astro)
 * - Fluid spacing that scales with container
 * - Full-bleed support for images and code blocks on mobile
 * - Proper heading hierarchy and accessible structure
 */
---

<article id="article" class="post-content app-prose" data-testid="post-content">
  <slot />
</article>

<style>
  /* ==========================================================================
     RESPONSIVE POST CONTENT - Centering Strategy
     ==========================================================================
     Provides optimal reading experience with:
     - Container queries for responsive typography
     - 720px width from parent container
     - Fluid vertical rhythm
     - Full-bleed elements on mobile
     ========================================================================== */

  .post-content {
    /* Fluid spacing */
    --content-gap: clamp(1.5rem, 1rem + 1.5vw, 2.5rem);

    /* Layout - full width of parent (720px container) */
    width: 100%;

    /* Prevent overflow from code blocks and tables */
    min-width: 0;
    overflow-wrap: break-word;
  }

  /* Centered headings */
  .post-content :global(h1),
  .post-content :global(h2),
  .post-content :global(h3),
  .post-content :global(h4),
  .post-content :global(h5),
  .post-content :global(h6) {
    text-align: center;
  }

  /* ==========================================================================
     FLUID CONTENT ASSETS - Container Query Enhancements
     ==========================================================================
     Component-level responsive behavior for media elements
     ========================================================================== */

  /* Base figure styling */
  .post-content :global(figure) {
    container-type: inline-size;
    container-name: content-figure;
  }

  /* Wide figures - Optional class for images that should break out */
  .post-content :global(figure.wide) {
    --figure-bleed: clamp(1rem, 0.5rem + 2vw, 3rem);
    margin-inline: calc(var(--figure-bleed) * -1);
    width: calc(100% + var(--figure-bleed) * 2);
  }

  /* Full-width figures - Break out to viewport edges */
  .post-content :global(figure.full) {
    position: relative;
    left: 50%;
    right: 50%;
    margin-left: -50vw;
    margin-right: -50vw;
    width: 100vw;
    max-width: 100vw;
  }

  /* Responsive image grid for multiple images */
  .post-content :global(figure.grid) {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(min(200px, 100%), 1fr));
    gap: clamp(0.5rem, 0.25rem + 0.5vw, 1rem);

    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  }

  /* Video container with fluid aspect ratio */
  .post-content :global(.video-container) {
    position: relative;
    width: 100%;
    aspect-ratio: 16 / 9;
    overflow: hidden;
    border-radius: clamp(0.5rem, 0.25rem + 0.5vw, 1rem);
    background-color: var(--color-muted);

    iframe,
    video {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border-radius: inherit;
    }
  }

  /* ==========================================================================
     CONTAINER QUERIES - Component-level Responsiveness
     ========================================================================== */

  /* Narrow containers (< 400px) - Mobile optimizations */
  @container post-content (max-width: 25rem) {
    .post-content {
      --content-gap: 1rem;
    }

    /* Full-bleed for code blocks and figures on mobile */
    .post-content :global(pre),
    .post-content :global(figure),
    .post-content :global(.astro-code),
    .post-content :global(table) {
      margin-inline: calc(var(--article-padding-inline, 1rem) * -1);
      width: calc(100% + var(--article-padding-inline, 1rem) * 2);
      border-radius: 0;
      border-inline: none;
    }

    /* Full-bleed images on narrow containers */
    .post-content :global(img) {
      border-radius: 0;
      box-shadow: none;
    }

    /* Full-bleed videos and embeds */
    .post-content :global(video),
    .post-content :global(iframe),
    .post-content :global(.video-container) {
      margin-inline: calc(var(--article-padding-inline, 1rem) * -1);
      width: calc(100% + var(--article-padding-inline, 1rem) * 2);
      border-radius: 0;
    }

    /* Compact captions on narrow containers */
    .post-content :global(figcaption) {
      padding-inline: 0;
    }
  }

  /* Wide containers (≥ 500px) - Enhanced spacing */
  @container post-content (min-width: 31.25rem) {
    .post-content {
      --content-gap: clamp(1.75rem, 1.25rem + 1vw, 2.5rem);
    }
  }

  /* Extra wide containers (≥ 700px) - Maximum breathing room */
  @container post-content (min-width: 43.75rem) {
    .post-content {
      --content-gap: clamp(2rem, 1.5rem + 1vw, 3rem);
    }

    /* Larger border radius on wide containers */
    .post-content :global(img) {
      border-radius: 1rem;
    }

    .post-content :global(video),
    .post-content :global(iframe),
    .post-content :global(.video-container) {
      border-radius: 1rem;
    }

    /* Enhanced hover effect on wide containers */
    .post-content :global(a img:hover) {
      transform: scale(1.02);
      box-shadow:
        0 20px 25px -5px rgb(0 0 0 / 0.1),
        0 8px 10px -6px rgb(0 0 0 / 0.1);
    }
  }

  /* ==========================================================================
     VIEWPORT FALLBACKS
     ========================================================================== */

  @supports not (container-type: inline-size) {
    .post-content {
      max-width: 720px;
      margin-inline: auto;
    }

    @media (max-width: 640px) {
      .post-content :global(pre),
      .post-content :global(figure),
      .post-content :global(table) {
        margin-inline: -1rem;
        width: calc(100% + 2rem);
        border-radius: 0;
      }

      .post-content :global(img) {
        border-radius: 0;
      }
    }
  }
</style>

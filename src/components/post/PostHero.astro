---
/**
 * Responsive Post Hero Component
 * ================================
 * Article header with fluid typography and elastic spacing.
 *
 * Features:
 * - Container queries for component-level responsiveness
 * - Fluid typography using clamp() capped at 1280px
 * - Elastic spacing that scales proportionally
 * - Semantic HTML with proper heading hierarchy
 * - View Transitions support for smooth navigation
 */
import { slugifyStr } from "@/utils/core";
import Datetime from "./Datetime.astro";
import ReadingTime from "./ReadingTime.astro";

export interface Props {
  title: string;
  pubDatetime: Date;
  modDatetime?: Date | null;
  timezone?: string;
  readingTimeText: string;
}

const { title, pubDatetime, modDatetime, timezone, readingTimeText } =
  Astro.props;
---

<header class="post-hero">
  <h1
    transition:name={slugifyStr(title)}
    class="post-hero__title"
    data-testid="post-title"
  >
    {title}
  </h1>
  <div class="post-hero__meta">
    <Datetime {pubDatetime} {modDatetime} {timezone} size="sm" />
    <span class="post-hero__divider" aria-hidden="true">/</span>
    <ReadingTime text={readingTimeText} size="sm" />
  </div>
</header>

<style>
  /* ==========================================================================
     RESPONSIVE POST HERO - Fluid Typography & Centering
     ==========================================================================
     Uses modern CSS for smooth scaling:
     - Container queries for component-level breakpoints
     - Fluid typography with clamp()
     - Logical properties for RTL support
     ========================================================================== */

  .post-hero {
    /* Fluid spacing */
    --hero-margin-block-start: clamp(1.5rem, 1rem + 2vw, 3rem);
    --hero-margin-block-end: clamp(2rem, 1.5rem + 2.5vw, 4rem);
    --hero-gap: clamp(1rem, 0.75rem + 0.5vw, 1.5rem);

    /* Layout - full width of parent (720px container) */
    width: 100%;
    margin-block-start: var(--hero-margin-block-start);
    margin-block-end: var(--hero-margin-block-end);
    text-align: center;
  }

  /* Title - Fluid typography */
  .post-hero__title {
    /* Fluid: 1.75rem (28px) → 3rem (48px), capped at 1280px */
    font-size: clamp(1.75rem, 1.25rem + 2.5vw, 3rem);
    font-weight: 700;
    line-height: 1.15;
    letter-spacing: -0.02em;
    color: var(--color-foreground);
    margin: 0;
    margin-block-end: var(--hero-gap);
    text-wrap: balance;
  }

  /* Metadata Row */
  .post-hero__meta {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    justify-content: center;
    gap: clamp(0.5rem, 0.375rem + 0.375vw, 0.75rem);
    font-size: clamp(0.8125rem, 0.75rem + 0.125vw, 0.875rem);
    color: var(--color-text-secondary);
  }

  .post-hero__divider {
    color: var(--color-border);
  }

  /* ==========================================================================
     CONTAINER QUERIES - Component-level Responsiveness
     ========================================================================== */

  /* Narrow containers (< 300px) - Ultra compact */
  @container post-hero (max-width: 18.75rem) {
    .post-hero__title {
      font-size: clamp(1.5rem, 1.25rem + 1.5vw, 2rem);
    }

    .post-hero__meta {
      flex-direction: column;
      gap: 0.375rem;
    }

    .post-hero__divider {
      display: none;
    }
  }

  /* Wide containers (≥ 500px) - Enhanced spacing */
  @container post-hero (min-width: 31.25rem) {
    .post-hero {
      --hero-margin-block-start: clamp(2rem, 1.5rem + 2vw, 3.5rem);
      --hero-margin-block-end: clamp(2.5rem, 2rem + 2vw, 4.5rem);
    }

    .post-hero__title {
      font-size: clamp(2rem, 1.5rem + 2vw, 3.25rem);
    }
  }

  /* Extra wide containers (≥ 700px) - Maximum expression */
  @container post-hero (min-width: 43.75rem) {
    .post-hero__title {
      font-size: clamp(2.25rem, 1.75rem + 1.5vw, 3.5rem);
      letter-spacing: -0.03em;
    }
  }

  /* ==========================================================================
     VIEWPORT FALLBACKS
     ========================================================================== */

  @supports not (container-type: inline-size) {
    .post-hero {
      margin-block: 2rem 3rem;
    }

    .post-hero__title {
      font-size: 2rem;
    }

    @media (min-width: 40rem) {
      .post-hero__title {
        font-size: 2.5rem;
      }
    }

    @media (min-width: 64rem) {
      .post-hero__title {
        font-size: 3rem;
      }
    }
  }
</style>

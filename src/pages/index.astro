---
// FILE: src/pages/index.astro

// This page is now a static HTML shell with a client-side script for redirection.
// It no longer uses any server-side Astro APIs.
const supportedLocales = ["en", "ka"];
const defaultLocale = "en";
---

<!DOCTYPE html>
<html lang="en" data-pagefind-ignore="all">
<head>
    <meta charset="UTF-8">
    <title>Redirecting...</title>
    <script is:inline define:vars={{ supportedLocales, defaultLocale }}>
      /**
       * Client-side redirect to the user's preferred language.
       * This runs instantly in the browser, preserving the benefits of a static site.
       */
      function getPreferredLocale() {
        // Check navigator.languages for the most specific user preference.
        for (const lang of navigator.languages) {
          const locale = lang.split('-')[0]; // Use the primary language code (e.g., "en" from "en-US")
          if (supportedLocales.includes(locale)) {
            return locale;
          }
        }
        // Fallback to the default locale.
        return defaultLocale;
      }

      // Perform the redirect.
      const preferredLocale = getPreferredLocale();
      window.location.pathname = `/${preferredLocale}/`;
    </script>
    <noscript>
      <!-- Fallback for users with JavaScript disabled -->
      <meta http-equiv="refresh" content={`0;url=/${defaultLocale}/`} />
    </noscript>
</head>
<body>
  <p>If you are not redirected automatically, <a href={`/${defaultLocale}/`}>click here</a>.</p>
</body>
</html>

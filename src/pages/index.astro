---
// FILE: src/pages/index.astro
import { DEFAULT_LANG } from "@/i18n/config";

// Calculate the absolute URL for the default locale to establish canonical authority
const destination = `/${DEFAULT_LANG}/`;
---

<!doctype html>
<html lang={DEFAULT_LANG}>
  <head>
    <meta charset="UTF-8" />
    <title>Redirecting...</title>
    <meta name="robots" content="noindex, nofollow" />

    <!-- 1. Canonical: Tells Google "The real content is at /en/" -->
    <link rel="canonical" href={destination} />

    <!-- 2. Meta Refresh: The fastest browser-native redirect (0 seconds) -->
    <!-- Acts as a fallback if JS is disabled or Vercel config is missing (localhost) -->
    <meta http-equiv="refresh" content={`0;url=${destination}`} />

    <!-- 3. Script: Minimal, non-blocking fallback for language detection in local dev -->
    <script is:inline define:vars={{ destination }}>
      // Short-circuit: If this page loaded, edge redirection didn't happen.
      // We prioritize speed over perfect language detection here.
      window.location.href = destination;
    </script>
  </head>
  <body>
    <p>
      Redirecting to <a href={destination}>{destination}</a>...
    </p>
  </body>
</html>

---
// FILE: src/pages/index.astro
import { DEFAULT_LANG } from "@/i18n/config";

// Calculate the absolute URL for the default locale
const destination = `/${DEFAULT_LANG}/`;

// FIX: Retrieve the verification code for the root page
const PUBLIC_GOOGLE_SITE_VERIFICATION = import.meta.env
  .PUBLIC_GOOGLE_SITE_VERIFICATION;
---

<!doctype html>
<html lang={DEFAULT_LANG}>
  <head>
    <meta charset="UTF-8" />
    <title>Redirecting...</title>

    <!-- 
      IMPORTANT: We keep noindex here to prevent Google from indexing this empty 
      redirect page, BUT we add the verification tag below so Google 
      knows you own the domain.
    -->
    <meta name="robots" content="noindex, nofollow" />

    <!-- FIX: This is what Google Search Console is looking for -->
    {
      PUBLIC_GOOGLE_SITE_VERIFICATION && (
        <meta
          name="google-site-verification"
          content={PUBLIC_GOOGLE_SITE_VERIFICATION}
        />
      )
    }

    <!-- 1. Canonical: Tells Google "The real content is at /en/" -->
    <link rel="canonical" href={destination} />

    <!-- 2. Meta Refresh: The fastest browser-native redirect -->
    <meta http-equiv="refresh" content={`0;url=${destination}`} />

    <!-- 3. Script: Fallback redirect -->
    <script is:inline define:vars={{ destination }}>
      window.location.href = destination;
    </script>
  </head>
  <body>
    <p>
      Redirecting to <a href={destination}>{destination}</a>...
    </p>
  </body>
</html>

---
import { PostRepository } from "@/utils/post/repository";
import Layout from "@/layouts/Layout.astro";
import Header from "@/components/layout/Header.astro";
import Footer from "@/components/layout/Footer.astro";
import Hero from "@/components/features/Hero.astro";
import Socials from "@/components/features/Socials.astro";
import Hr from "@/components/ui/Hr.astro";
import FeaturedPostCard from "@/components/post/FeaturedPostCard.astro";
import { getSocials } from "@/data/socials";
import { SITE } from "@/config";
import { getI18n, type Lang } from "@/i18n";
import profilePic from "@/assets/images/me.jpeg";

// Get translations for current locale
const { t } = getI18n(Astro.currentLocale as Lang);

// Get posts only for the Georgian language using the centralized repository
const sortedPosts = await PostRepository.getByLocale("ka");
const featuredPosts = sortedPosts.filter(({ data }) => data.featured);
const socials = getSocials();

// Georgian Hero content
const heroContent = {
  tagline: ".NET დეველოპერი  |  პროგრამული ინჟინერი",
  description:
    "მიკროსერვისების არქიტექტურაში სპეციალიზირებული .NET დეველოპერი და პროგრამული ინჟინერი",
  techStack: [".NET Core", "Microservices", "AI/ML", "TypeScript", "Astro"],
  additionalContent: [
    `ყოველდღიური მიღწევები მოიცავს საკრედიტო რეპორტირების სისტემის
    მიგრაციას მონოლიტიდან მიკროსერვისებზე <span class="highlight">40% შესრულების გაუმჯობესება</span>,
    ქართულენოვანი AI ასისტენტის არქიტექტურას, რომელმაც მოიპოვა <span class="highlight">ჟიური Prize Award-ი</span>
    GAIA Hackathon-ზე, და საწარმო-კლასის სისტემებზე, როგორიცაა
    <a href="https://github.com/NikaNats">Blogify API</a> და fintech მიკროსერვისების ეკოსისტემები.`,
    `მიზნად ისახავს მაგისტრის ხარისხის მიღებას მონაცემთა მეცნიერების
    ფაკულტეტზე საქართველოს ეროვნული უნივერსიტეტში, ხოლო პრაქტიკულად
    მუშაობს .NET პროგრამული ინჟინერად Credo Bank-ში. მოგვწერეთ <a href="mailto:nika.nacvlishvili1@gmail.com">ელ-ფოსტით</a>
    .NET, მიკროსერვისებების ან AI/ML ინტეგრაციის შესახებ განსახილველი საკითხების შესაფერი.`,
  ],
};
---

<Layout>
  <Header />
  <main
    id="main-content"
    data-layout="index"
    class="mx-auto flex h-svh w-full max-w-app flex-col items-center justify-center px-4"
  >
    <Hero
      name={SITE.author}
      tagline={heroContent.tagline}
      description={heroContent.description}
      additionalContent={heroContent.additionalContent}
      profileImage={profilePic}
      profileAlt={`${SITE.author}-ის პროფილის ფოტო`}
      techStack={heroContent.techStack}
    >
      {
        socials.length > 0 && (
          <div slot="socials">
            <Socials links={socials} />
          </div>
        )
      }
    </Hero>

    <Hr />

    {
      featuredPosts.length > 0 && (
        <>
          <Hr />
          <section id="featured-posts" class="py-8">
            <h2 class="mb-6 text-2xl font-bold">{t("hero.featuredPosts")}</h2>
            <ul class="grid gap-4 sm:grid-cols-2">
              {featuredPosts.map(({ data, id, body }) => (
                <FeaturedPostCard
                  href={`/ka/posts/${id}`}
                  frontmatter={data}
                  body={body}
                />
              ))}
            </ul>
          </section>
        </>
      )
    }
  </main>
  <Footer />
</Layout>

<script>
  document.addEventListener("astro:page-load", () => {
    const indexLayout = (document.querySelector("#main-content") as HTMLElement)
      ?.dataset?.layout;
    if (indexLayout) {
      sessionStorage.setItem("backUrl", "/ka/");
    }
  });
</script>

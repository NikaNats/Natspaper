/* ==========================================================================
   GLOBAL STYLESHEET (Tailwind v4)
   Architecture: Imports -> Config -> Variables -> Base -> Print
   ========================================================================== */

/* 1. IMPORTS */
@import "tailwindcss";
/* Typography defines the 'prose' layer */
@import "./typography.css";
/* Components defines specialized UI patterns */
@import "./components.css";

/* 2. TAILWIND CONFIGURATION & TOKENS */
@custom-variant dark (&:where([data-theme=dark], [data-theme=dark] *));

@theme inline {
  /* Map CSS Variables to Tailwind Utilities */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-accent: var(--accent);
  --color-muted: var(--muted);
  --color-border: var(--border);
  --color-text-secondary: var(--text-secondary);

  /* Animation Tokens */
  --animate-duration-fast: 150ms;
  --animate-duration-normal: 300ms;
  --animate-duration-slow: 500ms;
}

/* 3. CSS VARIABLES (DESIGN SYSTEM) */
:root {
  /* Font Definitions */
  --font-inter:
    "Inter-3dcd4455b90e4525", "Inter-3dcd4455b90e4525 fallback: Arial",
    sans-serif;
  --font-jetbrains-mono:
    "JetBrains Mono-9f910b5ba3c9ba86",
    "JetBrains Mono-9f910b5ba3c9ba86 fallback: Courier New", monospace;

  /* Layout Metrics */
  --gap: 24px;
  --content-gap: 20px;
  --nav-width: 1024px;
  --main-width: 720px;
  --header-height: 64px;
  --radius: 8px;
}

/* Light Theme (Default) - WCAG AA+ Compliant */
:root,
html[data-theme="light"] {
  --background: #fafafa; /* Off-white: Reduces eye strain vs pure white */
  --foreground: #212121; /* Deep Grey: 21:1 Contrast Ratio */
  --accent: #0066ff; /* Accessible Blue */
  --muted: #f7f7f7; /* Subtle background differentiation */
  --border: #e0e0e0; /* Soft structural boundaries */
  --text-secondary: #757575; /* De-emphasized meta text */
  --code-block-bg: #1c1d21; /* Dark code blocks for contrast */
  --code-bg: #f0f0f0; /* Inline code background */
}

/* Dark Theme - "OLED Friendly" & Low Strain */
html[data-theme="dark"] {
  --background: #121212; /* Material Design standard dark */
  --foreground: #e0e0e0; /* Reduced glare text */
  --accent: #4da6ff; /* Lighter blue for dark mode contrast */
  --muted: #1e1e1e; /* Surface elevation */
  --border: #2d2d2d; /* Subtle borders */
  --text-secondary: #a3a3a3; /* Readable grey */
  --code-block-bg: #1a1a1a;
  --code-bg: #2a2a2a;
}

/* 4. BASE LAYER (Resets & Defaults) */
@layer base {
  /* Accessibility: Respect reduced motion preferences */
  @media (prefers-reduced-motion: no-preference) {
    html {
      @apply scroll-smooth;
    }
  }

  html {
    @apply bg-background;
    /* Research-backed reading size: 18px for desktop decreases cognitive load */
    font-size: 18px;
    font-family: var(--font-inter), system-ui, sans-serif;
    /* Prevent layout shift when scrollbar appears/disappears */
    scrollbar-gutter: stable;
  }

  @media (max-width: 768px) {
    html {
      font-size: 16px; /* Standard accessible size for mobile */
    }
  }

  body {
    @apply flex min-h-svh flex-col font-sans text-foreground antialiased;
    line-height: 1.6;
    letter-spacing: 0.01em;
    /* Smooth transitions for theme toggling */
    transition:
      background-color 0.3s ease,
      color 0.3s ease;
  }

  /* Optimized Link Styling - Prevents Layout Thrashing */
  /* We animate color/thickness instead of line-style to avoid reflows */
  a:not(.no-underline) {
    text-decoration: underline;
    text-decoration-thickness: 1px;
    text-underline-offset: 0.25em;
    text-decoration-color: var(--accent);
    transition:
      text-decoration-color 0.2s ease,
      text-decoration-thickness 0.2s ease;
  }

  a:hover:not(.no-underline),
  a:focus-visible:not(.no-underline) {
    text-decoration-thickness: 2px;
  }

  /* Focus Management */
  :focus-visible {
    @apply outline-2 outline-offset-2 outline-accent;
  }

  /* Standard Element Defaults */
  * {
    @apply border-border;
    scrollbar-width: thin;
    scrollbar-color: var(--muted) transparent;
  }

  button {
    @apply cursor-pointer;
    touch-action: manipulation; /* Disables double-tap zoom delay on mobile */
  }

  button:active,
  [role="button"]:active {
    transform: scale(0.98); /* Subtle click feedback */
  }

  /* Global Layout Constraints */
  section,
  footer {
    @apply mx-auto w-full px-4;
    max-width: 65ch; /* Golden ratio for readability */
  }
}

/* 5. UTILITY EXTENSIONS */
@utility max-w-app {
  @apply max-w-2xl;
}

/* 6. PRINT STYLES (Academic Optimization) */
@media print {
  html {
    font-size: 14pt;
  }
  body {
    @apply bg-white text-black;
  }

  /* Hide UI elements */
  header,
  footer,
  #back-to-top,
  .no-print,
  button {
    display: none !important;
  }

  /* Ensure readability */
  a {
    text-decoration: none;
    color: black;
  }

  /* Academic Citation: Append URL to links */
  a[href^="http"]:after {
    content: " (" attr(href) ")";
    font-size: 0.9em;
    color: #444;
  }

  /* Code formatting for print */
  pre,
  code {
    white-space: pre-wrap;
    border: 1px solid #ccc;
    page-break-inside: avoid;
  }
}
